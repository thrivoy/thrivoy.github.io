<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thrivoy Centaur | Expert-AI Knowledge Validation System</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>游</text></svg>">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .navbar-brand { 
            font-weight: bold; 
            color: #007BFF !important; 
        }

        .container-main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .section {
            padding: 3rem 1rem;
        }

        .header-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-section h1 {
            color: #007BFF;
            font-size: 2.5em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .header-section p {
            color: #6c757d;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .system-status {
            background: rgba(56, 161, 105, 0.1);
            border: 1px solid #38a169;
            border-radius: 8px;
            padding: 12px;
            margin-top: 15px;
            font-size: 0.9em;
            color: #2f855a;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .system-status.demo {
            background: rgba(245, 158, 11, 0.1);
            border-color: #f59e0b;
            color: #92400e;
        }

        .system-status.error {
            background: rgba(229, 62, 62, 0.1);
            border-color: #e53e3e;
            color: #c53030;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: white;
            border-radius: 12px;
            padding: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            margin: 2px;
            border: none;
            background: transparent;
            color: #495057;
            font-size: 14px;
        }

        .nav-tab.active {
            background: #007BFF;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
        }

        .nav-tab:not(.active):hover {
            background: rgba(0, 123, 255, 0.1);
            transform: translateY(-1px);
        }

        .nav-tab:focus {
            outline: 2px solid #007BFF;
            outline-offset: 2px;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            font-size: 14px;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
            font-family: inherit;
        }

        .form-control:focus {
            outline: none;
            border-color: #007BFF;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            background: #007BFF;
            color: white;
            border: 1px solid #007BFF;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 16px;
            font-weight: 400;
            transition: all 0.15s ease-in-out;
            margin-right: 10px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn:hover:not(:disabled) {
            background-color: #0056b3;
            border-color: #0056b3;
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.65;
            cursor: not-allowed;
            transform: none;
        }

        .btn-outline-primary {
            background: transparent;
            color: #007BFF;
            border: 1px solid #007BFF;
        }

        .btn-outline-primary:hover:not(:disabled) {
            background: #007BFF;
            color: white;
        }

        .btn-success {
            background: #28a745;
            border-color: #28a745;
        }

        .btn-success:hover:not(:disabled) {
            background: #218838;
            border-color: #1e7e34;
        }

        .btn-danger {
            background: #dc3545;
            border-color: #dc3545;
        }

        .btn-danger:hover:not(:disabled) {
            background: #c82333;
            border-color: #bd2130;
        }

        .btn-secondary {
            background: #6c757d;
            border-color: #6c757d;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #5a6268;
            border-color: #545b62;
        }

        .status {
            padding: 15px;
            border-radius: 0.375rem;
            margin: 15px 0;
            font-weight: 500;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .status.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .status.info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .queue-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 0.5rem;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .queue-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .queue-item h3 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .queue-item p {
            margin-bottom: 8px;
            color: #6c757d;
        }

        .queue-item strong {
            color: #495057;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 0.5rem;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            border: 1px solid #dee2e6;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #007BFF;
            display: block;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #007BFF;
            animation: spin 1s ease-in-out infinite;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .response-section {
            background: #f8f9fa;
            border-radius: 0.5rem;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #007BFF;
            animation: slideIn 0.3s ease;
        }

        .response-section h3 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-items {
            background: #d4edda;
            border-radius: 0.5rem;
            padding: 20px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }

        .action-items h3 {
            color: #155724;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-items ol {
            padding-left: 20px;
        }

        .action-items li {
            margin-bottom: 8px;
            color: #495057;
            line-height: 1.5;
        }

        .hidden {
            display: none;
        }

        .offline-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 12px;
            border-radius: 0.375rem;
            margin-bottom: 20px;
            display: none;
        }

        .footer { 
            background-color: #343a40; 
            color: white; 
            padding: 3rem 1rem; 
            margin-top: 4rem;
        } 

        .footer a { 
            color: #adb5bd; 
            text-decoration: none; 
        } 

        .footer a:hover { 
            color: white; 
        }

        /* Enhanced mobile responsiveness */
        @media (max-width: 768px) {
            .container-main {
                padding: 10px;
            }
            
            .header-section {
                padding: 20px;
            }
            
            .header-section h1 {
                font-size: 1.8em;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .nav-tab {
                flex: 1;
                min-width: 120px;
                text-align: center;
                padding: 10px 12px;
                font-size: 13px;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .stat-number {
                font-size: 2em;
            }
        }

        /* Loading button states */
        .btn .loading {
            margin-left: 8px;
        }

        /* Accessibility improvements */
        .btn:focus,
        .nav-tab:focus {
            outline: 2px solid #007BFF;
            outline-offset: 2px;
        }

        /* Connection status indicator */
        .connection-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #28a745;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .connection-indicator.demo {
            background: #ffc107;
        }

        .connection-indicator.error {
            background: #dc3545;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="../index.html">Thrivoy</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" href="../approach.html">Our Approach</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../platforms.html">Our Platforms</a>
                    </li>
                    <li class="nav-item ml-lg-3">
                        <a class="btn btn-primary" href="../contact.html">Apply for a Consultation</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="connection-indicator" id="connectionIndicator" title="System Status"></div>
    
    <div class="section">
        <div class="container-main">
            <div class="header-section">
                <h1>Thrivoy Centaur</h1>
                <p>Expert-AI Knowledge Validation System</p>
                <p class="text-muted">Curated expert knowledge meets advanced AI processing</p>
                <div id="system-status" class="system-status">
                    <span id="status-icon">游리</span>
                    <span id="status-text">Initializing system...</span>
                </div>
            </div>

            <div id="offline-notice" class="offline-notice">
                <strong>Offline Mode:</strong> Some features may be limited. Please check your internet connection.
            </div>

            <div class="nav-tabs" role="tablist">
                <button class="nav-tab active" role="tab" onclick="showTab('query')" aria-selected="true">AI Query</button>
                <button class="nav-tab" role="tab" onclick="showTab('submit')" aria-selected="false">Submit Knowledge</button>
                <button class="nav-tab" role="tab" onclick="showTab('validate')" aria-selected="false">Validation Queue</button>
                <button class="nav-tab" role="tab" onclick="showTab('stats')" aria-selected="false">System Stats</button>
            </div>

            <div id="query-tab" class="tab-content active" role="tabpanel">
                <h2>Ask the AI Expert System</h2>
                <div class="form-group">
                    <label for="userQuery">Your Question or Challenge:</label>
                    <textarea id="userQuery" class="form-control" placeholder="Describe your situation, challenge, or question. The AI will provide strategic, interpersonal, and professional guidance based on validated expert knowledge..." rows="4" aria-describedby="query-help"></textarea>
                    <small id="query-help" class="form-text text-muted">Tip: Be specific about your situation for better guidance</small>
                </div>
                <button class="btn" onclick="processQuery()" id="query-btn">
                    <span id="query-btn-text">Get Expert Guidance</span>
                    <span id="query-loading" class="loading hidden" aria-hidden="true"></span>
                </button>
                
                <div id="query-status" role="status" aria-live="polite"></div>
                <div id="ai-response" role="region" aria-label="AI Response"></div>
            </div>

            <div id="submit-tab" class="tab-content" role="tabpanel">
                <h2>Submit Expert Knowledge</h2>
                <form id="expertForm" onsubmit="return false;">
                    <div class="form-group">
                        <label for="expertId">Expert ID:</label>
                        <input type="text" id="expertId" class="form-control" placeholder="Your unique expert identifier" required autocomplete="username">
                    </div>
                    
                    <div class="form-group">
                        <label for="secretKey">Expert Secret Key:</label>
                        <input type="password" id="secretKey" class="form-control" placeholder="Your expert access key" required autocomplete="current-password">
                    </div>
                    
                    <div class="form-group">
                        <label for="domain">Domain/Field:</label>
                        <select id="domain" class="form-control" required>
                            <option value="">Select domain...</option>
                            <option value="Leadership">Leadership</option>
                            <option value="Management">Management</option>
                            <option value="Communication">Communication</option>
                            <option value="Conflict Resolution">Conflict Resolution</option>
                            <option value="Career Development">Career Development</option>
                            <option value="Team Building">Team Building</option>
                            <option value="Strategy">Strategy</option>
                            <option value="Innovation">Innovation</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="challengeType">Challenge Type:</label>
                        <input type="text" id="challengeType" class="form-control" placeholder="e.g., Remote Team Management, Difficult Conversations" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="scenario">Scenario Description:</label>
                        <textarea id="scenario" class="form-control" placeholder="Describe the specific situation or scenario this knowledge addresses..." rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="immediateGuidance">Immediate Guidance:</label>
                        <textarea id="immediateGuidance" class="form-control" placeholder="What should someone do first when facing this situation?" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="logicalFramework">Logical Framework (Optional):</label>
                        <textarea id="logicalFramework" class="form-control" placeholder="Structured approach, methodology, or framework to apply..." rows="2"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="emotionalIntelligence">Emotional Intelligence Considerations (Optional):</label>
                        <textarea id="emotionalIntelligence" class="form-control" placeholder="Emotional aspects, empathy considerations, interpersonal dynamics..." rows="2"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="socialProof">Social Proof/Evidence (Optional):</label>
                        <textarea id="socialProof" class="form-control" placeholder="Supporting evidence, case studies, research, or examples..." rows="2"></textarea>
                    </div>
                    
                    <button type="button" class="btn" onclick="submitExpertKnowledge()" id="submit-btn">
                        <span id="submit-btn-text">Submit Knowledge</span>
                        <span id="submit-loading" class="loading hidden" aria-hidden="true"></span>
                    </button>
                </form>
                
                <div id="submit-status" role="status" aria-live="polite"></div>
            </div>

            <div id="validate-tab" class="tab-content" role="tabpanel">
                <h2>Knowledge Validation Queue</h2>
                <div class="form-group">
                    <label for="validatorSecret">Validator Secret Key:</label>
                    <input type="password" id="validatorSecret" class="form-control" placeholder="Enter validator secret key" autocomplete="current-password">
                </div>
                <div class="form-group">
                    <label for="validatorId">Validator ID:</label>
                    <input type="text" id="validatorId" class="form-control" placeholder="Your validator identifier" autocomplete="username">
                </div>
                <button class="btn" onclick="loadValidationQueue()" id="load-queue-btn">
                    <span id="load-queue-text">Load Validation Queue</span>
                    <span id="load-queue-loading" class="loading hidden" aria-hidden="true"></span>
                </button>
                
                <div id="validation-status" role="status" aria-live="polite"></div>
                <div id="validation-queue" role="region" aria-label="Validation Queue"></div>
            </div>

            <div id="stats-tab" class="tab-content" role="tabpanel">
                <h2>System Statistics</h2>
                <button class="btn" onclick="loadSystemStats()" id="stats-btn">
                    <span id="stats-btn-text">Refresh Stats</span>
                    <span id="stats-loading" class="loading hidden" aria-hidden="true"></span>
                </button>
                
                <div id="stats-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span id="total-queries" class="stat-number">-</span>
                            <div class="stat-label">Total Queries</div>
                        </div>
                        <div class="stat-card">
                            <span id="validated-knowledge" class="stat-number">-</span>
                            <div class="stat-label">Validated Knowledge</div>
                        </div>
                        <div class="stat-card">
                            <span id="pending-validation" class="stat-number">-</span>
                            <div class="stat-label">Pending Validation</div>
                        </div>
                        <div class="stat-card">
                            <span id="avg-response-time" class="stat-number">-</span>
                            <div class="stat-label">Avg Response Time (ms)</div>
                        </div>
                    </div>
                </div>
                
                <div id="stats-status" role="status" aria-live="polite"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="container text-center">
            <p class="mb-2">춸 2025 The Thrivoy Group. All Rights Reserved.</p>
            <p><a href="../contact.html">Apply for a Consultation</a></p>
        </div>
    </div>

    <script>
        // ====================================
        // PRODUCTION CONFIGURATION
        // ====================================
        
        // TODO: Replace with your actual deployed Google Apps Script URL
        const PRODUCTION_API_URL = 'https://script.google.com/macros/s/AKfycbwiwtIuIUc7GRcsW5U4UWyhL7FIZsoYDviB7kK5Pz3O695e2aVzLXYRY2aIA736XYyy/exec';
        
        // Global variables
        let API_BASE_URL = '';
        let systemMode = 'initializing'; // 'production', 'demo', 'error'
        
        // ====================================
        // SYSTEM INITIALIZATION
        // ====================================
        
        function initializeAPIURL() {
            try {
                const hostname = window.location.hostname;
                
                if (hostname === 'localhost' || hostname === '127.0.0.1') {
                    // Local development
                    API_BASE_URL = 'DEMO_MODE';
                    systemMode = 'demo';
                    updateSystemStatus('demo', 'Demo Mode - Local Development');
                } else if (hostname.includes('github.io') || hostname.includes('githubusercontent.com')) {
                    // GitHub Pages - use production API
                    API_BASE_URL = PRODUCTION_API_URL;
                    systemMode = 'production';
                    updateSystemStatus('connecting', 'Connecting to Production API...');
                    testAPIConnection();
                } else if (hostname.includes('script.google.com')) {
                    // Apps Script environment
                    API_BASE_URL = window.location.origin + window.location.pathname;
                    systemMode = 'production';
                    updateSystemStatus('production', 'Production System Active');
                } else {
                    // Custom domain - use production API
                    API_BASE_URL = PRODUCTION_API_URL;
                    systemMode = 'production';
                    updateSystemStatus('connecting', 'Connecting to Production API...');
                    testAPIConnection();
                }
                
                console.log('System initialized - Mode:', systemMode, 'API URL:', API_BASE_URL);
                
            } catch (error) {
                console.error('Error initializing API URL:', error);
                API_BASE_URL = 'DEMO_MODE';
                systemMode = 'demo';
                updateSystemStatus('error', 'Initialization Error - Using Demo Mode');
            }
        }
        
        // Test connection to production API
        async function testAPIConnection() {
            try {
                console.log('Testing API connection to:', API_BASE_URL);
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout
                
                const response = await fetch(API_BASE_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain' },
                    body: JSON.stringify({ action: 'getStats', test: true }),
                    signal: controller.signal,
                    mode: 'cors'
                });
                
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        systemMode = 'production';
                        updateSystemStatus('production', 'Production System Connected');
                        console.log('API connection successful');
                    } else {
                        throw new Error('API test failed: ' + (result.error || 'Unknown error'));
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
            } catch (error) {
                console.warn('API connection test failed:', error.message);
                
                if (error.name === 'AbortError') {
                    console.log('API connection timeout - falling back to demo mode');
                } else {
                    console.log('API error - falling back to demo mode:', error.message);
                }
                
                API_BASE_URL = 'DEMO_MODE';
                systemMode = 'demo';
                updateSystemStatus('demo', 'Demo Mode - Production API Unavailable');
            }
        }
        
        function updateSystemStatus(status, message) {
            const statusElement = document.getElementById('system-status');
            const iconElement = document.getElementById('status-icon');
            const textElement = document.getElementById('status-text');
            const connectionIndicator = document.getElementById('connectionIndicator');
            
            if (!statusElement) return;
            
            // Update status display
            switch (status) {
                case 'production':
                    statusElement.className = 'system-status';
                    iconElement.textContent = '游릭';
                    connectionIndicator.className = 'connection-indicator';
                    connectionIndicator.title = 'Production System Connected';
                    break;
                case 'demo':
                    statusElement.className = 'system-status demo';
                    iconElement.textContent = '游리';
                    connectionIndicator.className = 'connection-indicator demo';
                    connectionIndicator.title = 'Demo Mode Active';
                    break;
                case 'error':
                    statusElement.className = 'system-status error';
                    iconElement.textContent = '游댮';
                    connectionIndicator.className = 'connection-indicator error';
                    connectionIndicator.title = 'System Error';
                    break;
                case 'connecting':
                    statusElement.className = 'system-status';
                    iconElement.textContent = '游리';
                    connectionIndicator.className = 'connection-indicator demo';
                    connectionIndicator.title = 'Connecting...';
                    break;
            }
            
            textElement.textContent = message;
        }
        
        // ====================================
        // ERROR BOUNDARY AND RESILIENCE
        // ====================================
        
        function handleGlobalError(error) {
            console.error('Global error:', error);
            updateSystemStatus('error', 'System Error Detected');
            showStatus('query-status', 'An unexpected error occurred. System running in fallback mode.', 'error');
        }
        
        window.addEventListener('error', handleGlobalError);
        window.addEventListener('unhandledrejection', function(event) {
            handleGlobalError(event.reason);
        });
        
        // ====================================
        // NETWORK STATUS DETECTION
        // ====================================
        
        function checkNetworkStatus() {
            const offlineNotice = document.getElementById('offline-notice');
            if (!navigator.onLine) {
                offlineNotice.style.display = 'block';
                updateSystemStatus('error', 'No Internet Connection');
            } else {
                offlineNotice.style.display = 'none';
                if (systemMode === 'error' && API_BASE_URL !== 'DEMO_MODE') {
                    // Try to reconnect
                    testAPIConnection();
                }
            }
        }
        
        window.addEventListener('online', function() {
            checkNetworkStatus();
            // Attempt to reconnect to production API
            if (API_BASE_URL !== 'DEMO_MODE') {
                updateSystemStatus('connecting', 'Reconnecting...');
                testAPIConnection();
            }
        });
        window.addEventListener('offline', checkNetworkStatus);
        
        // ====================================
        // TAB MANAGEMENT
        // ====================================
        
        function showTab(tabName) {
            try {
                // Hide all tabs
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                // Remove active class from all nav tabs
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.classList.remove('active');
                    tab.setAttribute('aria-selected', 'false');
                });
                // Show selected tab
                const selectedTab = document.getElementById(tabName + '-tab');
                if (selectedTab) {
                    selectedTab.classList.add('active');
                }
                
                // Add active class to clicked nav tab
                event.target.classList.add('active');
                event.target.setAttribute('aria-selected', 'true');
                
                // Clear any previous statuses when switching tabs
                clearAllStatuses();
            } catch (error) {
                console.error('Error switching tabs:', error);
                showStatus('query-status', 'Error switching tabs. Please refresh the page.', 'error');
            }
        }

        // ====================================
        // UTILITY FUNCTIONS
        // ====================================
        
        function showStatus(elementId, message, type = 'info') {
            try {
                const statusElement = document.getElementById(elementId);
                if (!statusElement) return;
                
                statusElement.innerHTML = `<div class="status ${type}">${message}</div>`;
                
                // Auto-hide success messages after 5 seconds
                if (type === 'success') {
                    setTimeout(() => {
                        statusElement.innerHTML = '';
                    }, 5000);
                }
            } catch (error) {
                console.error('Error showing status:', error);
            }
        }
        
        function clearAllStatuses() {
            try {
                ['query-status', 'submit-status', 'validation-status', 'stats-status'].forEach(id => {
                    const element = document.getElementById(id);
                    if (element) element.innerHTML = '';
                });
            } catch (error) {
                console.error('Error clearing statuses:', error);
            }
        }
        
        function setLoading(buttonId, isLoading) {
            try {
                const button = document.getElementById(buttonId);
                const loadingElement = document.getElementById(buttonId.replace('-btn', '-loading'));
                const textElement = document.getElementById(buttonId.replace('-btn', '-btn-text'));
                if (button && loadingElement && textElement) {
                    button.disabled = isLoading;
                    if (isLoading) {
                        loadingElement.classList.remove('hidden');
                    } else {
                        loadingElement.classList.add('hidden');
                    }
                }
            } catch (error) {
                console.error('Error setting loading state:', error);
            }
        }
        
        function sanitizeInput(input) {
            if (typeof input !== 'string') return input;
            return input.trim().replace(/[<>]/g, '');
        }
        
        // ====================================
        // ENHANCED API COMMUNICATION
        // ====================================
        
        async function makeAPIRequest(endpoint, data = {}) {
            try {
                // Demo mode responses
                if (API_BASE_URL === 'DEMO_MODE') {
                    console.log('Demo mode - generating sample response for:', endpoint);
                    await new Promise(resolve => setTimeout(resolve, 800 + Math.random() * 1200)); // Realistic delay
                    return generateDemoResponse(endpoint, data);
                }
                
                if (!navigator.onLine) {
                    throw new Error('No internet connection. Please check your network.');
                }
                
                const requestData = {
                    action: endpoint,
                    timestamp: new Date().toISOString(),
                    clientVersion: '1.0.0',
                    ...data
                };
                
                console.log('Making API request to:', API_BASE_URL, 'with action:', endpoint);
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout
                
                const response = await fetch(API_BASE_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify(requestData),
                    signal: controller.signal,
                    mode: 'cors',
                    cache: 'no-cache'
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                console.log('API response received for:', endpoint);
                
                // Validate response structure
                if (!result || typeof result !== 'object') {
                    throw new Error('Invalid response format from server');
                }
                
                return result;
                
            } catch (error) {
                console.error('API request failed:', error);
                
                if (error.name === 'AbortError') {
                    throw new Error('Request timeout. Please try again.');
                } else if (!navigator.onLine) {
                    throw new Error('No internet connection');
                } else if (systemMode === 'production') {
                    // In production mode, fall back to demo only after real error
                    console.log('Production API failed, falling back to demo mode');
                    API_BASE_URL = 'DEMO_MODE';
                    systemMode = 'demo';
                    updateSystemStatus('demo', 'Fallback to Demo Mode');
                    
                    // Retry with demo response
                    await new Promise(resolve => setTimeout(resolve, 500));
                    return generateDemoResponse(endpoint, data);
                } else {
                    throw error;
                }
            }
        }
        
        // Enhanced demo responses with more variety
        function generateDemoResponse(endpoint, data) {
            switch (endpoint) {
                case 'query':
                    return generateDemoQueryResponse(data.query);
                case 'getStats':
                    return {
                        success: true,
                        stats: {
                            totalQueries: Math.floor(Math.random() * 2000) + 1500,
                            validatedKnowledge: Math.floor(Math.random() * 150) + 75,
                            pendingValidation: Math.floor(Math.random() * 25) + 8,
                            avgResponseTime: Math.floor(Math.random() * 400) + 200
                        }
                    };
                case 'getValidationQueue':
                    return {
                        success: true,
                        queue: [
                            {
                                ID: 'demo-' + Date.now(),
                                challengeType: 'Remote Team Conflict Resolution',
                                domain: 'Management',
                                expertId: 'expert_demo_001',
                                timestamp: new Date().toISOString(),
                                scenario: 'A distributed team across three time zones is experiencing communication breakdowns and interpersonal conflicts affecting project delivery timelines.'
                            },
                            {
                                ID: 'demo-' + (Date.now() + 1),
                                challengeType: 'Leadership During Organizational Change',
                                domain: 'Leadership',
                                expertId: 'expert_demo_002',
                                timestamp: new Date(Date.now() - 3600000).toISOString(),
                                scenario: 'Company undergoing major restructuring needs guidance on maintaining team morale and productivity during transition period.'
                            }
                        ]
                    };
                case 'submit':
                case 'validateKnowledge':
                    return {
                        success: true,
                        message: `${endpoint} completed successfully (demo mode)`,
                        id: 'demo-' + Date.now()
                    };
                default:
                    return { success: false, error: 'Unknown endpoint' };
            }
        }
        
        function generateDemoQueryResponse(query) {
            // Generate contextual responses based on query keywords
            const keywords = query.toLowerCase();
            let response = {};
            
            if (keywords.includes('team') || keywords.includes('management')) {
                response = {
                    immediateGuidance: "Begin by scheduling individual one-on-one conversations with each team member to understand their perspectives and concerns before addressing the group dynamic.",
                    logicalFramework: "Apply the TEAM framework: Trust-building (establish psychological safety), Expectations (clarify roles and responsibilities), Alignment (ensure shared goals), Monitoring (regular check-ins and feedback loops).",
                    emotionalIntelligence: "Acknowledge that team challenges often stem from unmet emotional needs. Practice active listening, validate concerns, and create space for team members to express frustrations constructively.",
                    socialProof: "Research from Harvard Business School shows that teams with high psychological safety are 67% more likely to achieve their goals and report 27% lower turnover rates.",
                    actionItems: [
                        "Schedule individual meetings with each team member within 48 hours",
                        "Document common themes and concerns from these conversations",
                        "Design a team reset session focusing on shared goals and communication norms",
                        "Implement weekly check-ins to monitor progress and address issues early",
                        "Create clear escalation paths for future conflicts"
                    ]
                };
            } else if (keywords.includes('communication') || keywords.includes('conflict')) {
                response = {
                    immediateGuidance: "Pause and reframe the conversation by acknowledging all perspectives before moving toward solution-focused dialogue.",
                    logicalFramework: "Use the DESC model: Describe the situation objectively, Express your feelings, Specify desired changes, identify Consequences (both positive outcomes and potential issues if unaddressed).",
                    emotionalIntelligence: "Recognize that behind every conflict are unmet needs or values. Focus on understanding these underlying concerns rather than just surface-level disagreements.",
                    socialProof: "Conflict resolution research indicates that 85% of workplace disputes can be resolved through structured dialogue when all parties feel heard and respected.",
                    actionItems: [
                        "Schedule a private conversation in a neutral environment",
                        "Start by asking open-ended questions about their perspective",
                        "Share your own viewpoint using 'I' statements rather than accusations",
                        "Identify shared goals and values as common ground",
                        "Agree on specific next steps and follow-up timeline"
                    ]
                };
            } else if (keywords.includes('leadership') || keywords.includes('decision')) {
                response = {
                    immediateGuidance: "Gather comprehensive input from stakeholders while maintaining decision-making authority. Set a clear timeline for the decision process.",
                    logicalFramework: "Apply the DECIDE model: Define the problem clearly, Establish criteria for solutions, Consider alternatives, Identify best alternative, Develop action plan, Evaluate and monitor.",
                    emotionalIntelligence: "Consider the emotional impact of your decision on different stakeholders. Communicate the reasoning behind decisions to build trust and reduce resistance.",
                    socialProof: "Studies of executive decision-making show that leaders who involve stakeholders in the decision process see 40% higher implementation success rates.",
                    actionItems: [
                        "Define the decision scope and timeline clearly",
                        "Identify all stakeholders who will be affected",
                        "Gather input through structured consultation process",
                        "Document decision rationale for future reference",
                        "Plan communication strategy for decision announcement"
                    ]
                };
            } else {
                // Generic professional guidance
                response = {
                    immediateGuidance: "Start by clearly defining the challenge and its impact. Take time to understand all perspectives involved before rushing to solutions.",
                    logicalFramework: "Apply systematic problem-solving: Define (what exactly is the issue), Analyze (what factors contribute), Generate (multiple solution options), Evaluate (pros/cons of each), Implement (chosen solution), Monitor (track results).",
                    emotionalIntelligence: "Consider the emotional context surrounding this challenge. How are different people feeling? What concerns or fears might be driving behavior? Address these human elements alongside logical solutions.",
                    socialProof: "Professional development research consistently shows that systematic approaches combined with emotional awareness lead to more sustainable and effective outcomes.",
                    actionItems: [
                        "Document the current situation objectively",
                        "Identify key stakeholders and their concerns",
                        "Generate multiple potential approaches",
                        "Evaluate options against your goals and values",
                        "Create an implementation plan with clear milestones"
                    ]
                };
            }
            
            return { success: true, response };
        }
        
        // ====================================
        // AI QUERY PROCESSING
        // ====================================
        
        async function processQuery() {
            const query = sanitizeInput(document.getElementById('userQuery').value);
            if (!query) {
                showStatus('query-status', 'Please enter a question or challenge.', 'error');
                return;
            }
            
            if (query.length < 10) {
                showStatus('query-status', 'Please provide more detail in your question for better guidance.', 'error');
                return;
            }
            
            setLoading('query-btn', true);
            showStatus('query-status', 'Processing your query with AI expert system...', 'info');
            
            try {
                const result = await makeAPIRequest('query', { query });
                if (result.success) {
                    displayAIResponse(result.response);
                    showStatus('query-status', systemMode === 'demo' ? 'Demo response generated successfully!' : 'Query processed successfully!', 'success');
                } else {
                    throw new Error(result.error || 'Failed to process query');
                }
            } catch (error) {
                console.error('Query processing error:', error);
                showStatus('query-status', `Error: ${error.message}`, 'error');
                
                // Show fallback response on error
                if (systemMode !== 'demo') {
                    displayFallbackResponse();
                }
            } finally {
                setLoading('query-btn', false);
            }
        }
        
        function displayAIResponse(response) {
            const responseDiv = document.getElementById('ai-response');
            if (!response) {
                responseDiv.innerHTML = '<div class="status error">No response received from AI system.</div>';
                return;
            }
            
            let html = '';
            
            // Immediate Guidance Section
            if (response.immediateGuidance) {
                html += `
                    <div class="response-section">
                        <h3>游꿢 Immediate Guidance</h3>
                        <p>${escapeHtml(response.immediateGuidance)}</p>
                    </div>
                `;
            }
            
            // Logical Framework Section
            if (response.logicalFramework) {
                html += `
                    <div class="response-section">
                        <h3>游 Strategic Framework</h3>
                        <p>${escapeHtml(response.logicalFramework)}</p>
                    </div>
                `;
            }
            
            // Emotional Intelligence Section
            if (response.emotionalIntelligence) {
                html += `
                    <div class="response-section">
                        <h3>仇벒잺 Emotional Intelligence Considerations</h3>
                        <p>${escapeHtml(response.emotionalIntelligence)}</p>
                    </div>
                `;
            }
            
            // Social Proof Section
            if (response.socialProof) {
                html += `
                    <div class="response-section">
                        <h3>游늵 Supporting Evidence</h3>
                        <p>${escapeHtml(response.socialProof)}</p>
                    </div>
                `;
            }
            
            // Action Items
            if (response.actionItems && response.actionItems.length > 0) {
                html += `
                    <div class="action-items">
                        <h3>九 Recommended Actions</h3>
                        <ol>
                            ${response.actionItems.map(item => `<li>${escapeHtml(item)}</li>`).join('')}
                        </ol>
                    </div>
                `;
            }
            
            responseDiv.innerHTML = html;
        }

        function displayFallbackResponse() {
            const responseDiv = document.getElementById('ai-response');
            responseDiv.innerHTML = `
                <div class="response-section">
                    <h3>游꿢 General Guidance</h3>
                    <p>While the AI system processes your request, here's some foundational guidance: Step back and clearly define the core challenge. Consider multiple perspectives and potential solutions before taking action.</p>
                </div>
                <div class="action-items">
                    <h3>九 Immediate Steps</h3>
                    <ol>
                        <li>Document the specific details of your situation</li>
                        <li>Identify key stakeholders who might be affected</li>
                        <li>Consider 2-3 potential approaches</li>
                        <li>Consult with trusted colleagues or mentors</li>
                        <li>Try your query again when the system is available</li>
                    </ol>
                </div>
            `;
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // ====================================
        // EXPERT KNOWLEDGE SUBMISSION
        // ====================================
        
        async function submitExpertKnowledge() {
            const formData = {
                expertId: sanitizeInput(document.getElementById('expertId').value),
                secretKey: document.getElementById('secretKey').value,
                domain: document.getElementById('domain').value,
                challengeType: sanitizeInput(document.getElementById('challengeType').value),
                scenario: sanitizeInput(document.getElementById('scenario').value),
                immediateGuidance: sanitizeInput(document.getElementById('immediateGuidance').value),
                logicalFramework: sanitizeInput(document.getElementById('logicalFramework').value),
                emotionalIntelligence: sanitizeInput(document.getElementById('emotionalIntelligence').value),
                socialProof: sanitizeInput(document.getElementById('socialProof').value)
            };

            // Validate required fields
            const requiredFields = ['expertId', 'secretKey', 'domain', 'challengeType', 'scenario', 'immediateGuidance'];
            for (const field of requiredFields) {
                if (!formData[field] || formData[field].trim() === '') {
                    const fieldName = field.replace(/([A-Z])/g, ' $1').toLowerCase().replace('secret key', 'secret key');
                    showStatus('submit-status', `Please fill in the ${fieldName} field.`, 'error');
                    document.getElementById(field).focus();
                    return;
                }
            }
            
            // Validate minimum content length
            if (formData.scenario.length < 50) {
                showStatus('submit-status', 'Scenario description should be at least 50 characters for quality validation.', 'error');
                return;
            }
            
            if (formData.immediateGuidance.length < 30) {
                showStatus('submit-status', 'Immediate guidance should be at least 30 characters for meaningful advice.', 'error');
                return;
            }
            
            setLoading('submit-btn', true);
            showStatus('submit-status', 'Submitting expert knowledge for validation...', 'info');
            
            try {
                const result = await makeAPIRequest('submit', formData);
                if (result.success) {
                    showStatus('submit-status', `Knowledge submitted successfully! ${systemMode === 'demo' ? '(Demo mode)' : 'ID: ' + (result.id || 'Generated')}`, 'success');
                    document.getElementById('expertForm').reset();
                } else {
                    throw new Error(result.error || 'Failed to submit knowledge');
                }
            } catch (error) {
                console.error('Submission error:', error);
                showStatus('submit-status', `Error: ${error.message}`, 'error');
            } finally {
                setLoading('submit-btn', false);
            }
        }
        
        // ====================================
        // VALIDATION QUEUE MANAGEMENT
        // ====================================
        
        async function loadValidationQueue() {
            const validatorId = sanitizeInput(document.getElementById('validatorId').value);
            const validatorSecret = document.getElementById('validatorSecret').value;
            
            if (!validatorId || !validatorSecret) {
                showStatus('validation-status', 'Please enter both Validator ID and Secret Key.', 'error');
                return;
            }
            
            setLoading('load-queue-btn', true);
            showStatus('validation-status', 'Loading validation queue...', 'info');
            
            try {
                const result = await makeAPIRequest('getValidationQueue', { validatorId, validatorSecret });
                if (result.success) {
                    displayValidationQueue(result.queue || []);
                    showStatus('validation-status', `Loaded ${result.queue ? result.queue.length : 0} items from validation queue.`, 'success');
                } else {
                    throw new Error(result.error || 'Failed to load validation queue');
                }
            } catch (error) {
                console.error('Validation queue error:', error);
                showStatus('validation-status', `Error: ${error.message}`, 'error');
            } finally {
                setLoading('load-queue-btn', false);
            }
        }
        
        function displayValidationQueue(queue) {
            const queueDiv = document.getElementById('validation-queue');
            if (!queue || queue.length === 0) {
                queueDiv.innerHTML = '<div class="status info">No items in validation queue.</div>';
                return;
            }
            
            let html = '';
            queue.forEach((item, index) => {
                html += `
                    <div class="queue-item">
                        <h3>${escapeHtml(item.challengeType || 'Untitled')}</h3>
                        <p><strong>Domain:</strong> ${escapeHtml(item.domain || 'N/A')}</p>
                        <p><strong>Expert:</strong> ${escapeHtml(item.expertId || 'Anonymous')}</p>
                        <p><strong>Submitted:</strong> ${item.timestamp ? new Date(item.timestamp).toLocaleDateString() : 'Unknown'}</p>
                        <p><strong>Scenario:</strong> ${escapeHtml(item.scenario || 'No scenario provided').substring(0, 200)}${item.scenario && item.scenario.length > 200 ? '...' : ''}</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-success" onclick="validateKnowledge('${item.ID}', 'approve')">九 Approve</button>
                            <button class="btn btn-danger" onclick="validateKnowledge('${item.ID}', 'reject')">仇 Reject</button>
                            <button class="btn btn-secondary" onclick="viewFullKnowledge('${item.ID}')">游녜勇 View Details</button>
                        </div>
                    </div>
                `;
            });
            queueDiv.innerHTML = html;
        }
        
        async function validateKnowledge(knowledgeId, action) {
            const validatorId = sanitizeInput(document.getElementById('validatorId').value);
            const validatorSecret = document.getElementById('validatorSecret').value;
            
            if (!validatorId || !validatorSecret) {
                showStatus('validation-status', 'Please enter validator credentials first.', 'error');
                return;
            }
            
            try {
                showStatus('validation-status', `${action === 'approve' ? 'Approving' : 'Rejecting'} knowledge...`, 'info');
                const result = await makeAPIRequest('validateKnowledge', { knowledgeId, action, validatorId, validatorSecret });
                
                if (result.success) {
                    showStatus('validation-status', `Knowledge ${action}d successfully!`, 'success');
                    // Reload the queue after successful validation
                    setTimeout(() => loadValidationQueue(), 1000);
                } else {
                    throw new Error(result.error || `Failed to ${action} knowledge`);
                }
            } catch (error) {
                console.error('Validation error:', error);
                showStatus('validation-status', `Error: ${error.message}`, 'error');
            }
        }

        function viewFullKnowledge(knowledgeId) {
            // Create a modal or detailed view - for now showing alert
            const message = `Viewing knowledge details for ID: ${knowledgeId}\n\nIn production, this would open a detailed modal with all knowledge content for thorough review.`;
            alert(message);
        }
        
        // ====================================
        // SYSTEM STATISTICS
        // ====================================
        
        async function loadSystemStats() {
            setLoading('stats-btn', true);
            showStatus('stats-status', 'Loading system statistics...', 'info');
            
            try {
                const result = await makeAPIRequest('getStats');
                if (result.success) {
                    displaySystemStats(result.stats);
                    showStatus('stats-status', systemMode === 'demo' ? 'Demo statistics loaded' : 'Statistics loaded successfully!', 'success');
                } else {
                    throw new Error(result.error || 'Failed to load stats');
                }
            } catch (error) {
                console.error('Stats loading error:', error);
                showStatus('stats-status', `Error: ${error.message}`, 'error');
            } finally {
                setLoading('stats-btn', false);
            }
        }
        
        function displaySystemStats(stats) {
            document.getElementById('total-queries').textContent = stats.totalQueries || '0';
            document.getElementById('validated-knowledge').textContent = stats.validatedKnowledge || '0';
            document.getElementById('pending-validation').textContent = stats.pendingValidation || '0';
            document.getElementById('avg-response-time').textContent = stats.avgResponseTime || '0';
        }
        
        // ====================================
        // HEALTH CHECK AND MONITORING
        // ====================================
        
        async function performHealthCheck() {
            if (systemMode === 'demo') return true;
            
            try {
                const result = await makeAPIRequest('getStats');
                return result.success;
            } catch (error) {
                console.warn('Health check failed:', error);
                return false;
            }
        }
        
        // Periodic health check every 5 minutes
        setInterval(async () => {
            if (systemMode === 'production') {
                const isHealthy = await performHealthCheck();
                if (!isHealthy) {
                    updateSystemStatus('error', 'Production API Connection Lost');
                    API_BASE_URL = 'DEMO_MODE';
                    systemMode = 'demo';
                    setTimeout(() => {
                        updateSystemStatus('demo', 'Fallback to Demo Mode');
                    }, 2000);
                }
            }
        }, 300000); // 5 minutes
        
        // ====================================
        // KEYBOARD SHORTCUTS
        // ====================================
        
        document.addEventListener('keydown', function(event) {
            // Ctrl/Cmd + Enter to submit query
            if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && activeTab.id === 'query-tab') {
                    event.preventDefault();
                    processQuery();
                }
            }
            
            // Alt + 1-4 to switch tabs
            if (event.altKey && event.key >= '1' && event.key <= '4') {
                event.preventDefault();
                const tabs = ['query', 'submit', 'validate', 'stats'];
                const tabIndex = parseInt(event.key) - 1;
                if (tabs[tabIndex]) {
                    showTab(tabs[tabIndex]);
                }
            }
        });
        
        // ====================================
        // INITIALIZATION AND STARTUP
        // ====================================
        
        window.onload = function() {
            console.log('Expert-AI System starting up...');
            
            initializeAPIURL();
            checkNetworkStatus();
            
            // Set initial active tab
            document.getElementById('query-tab').classList.add('active');
            
            // Handle URL hash for deep linking
            if (window.location.hash) {
                const tabName = window.location.hash.substring(1);
                if (['query', 'submit', 'validate', 'stats'].includes(tabName)) {
                    showTab(tabName);
                }
            }
            
            // Load initial stats if in production mode
            if (systemMode === 'production') {
                setTimeout(loadSystemStats, 2000);
            }
            
            // Set up periodic connection monitoring
            setInterval(checkNetworkStatus, 60000); // Check every minute
            
            console.log('Expert-AI System initialization complete');
        };
        
        // ====================================
        // EXPORT FOR TESTING
        // ====================================
        
        // Expose functions for testing in development
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = {
                processQuery,
                submitExpertKnowledge,
                loadValidationQueue,
                loadSystemStats,
                sanitizeInput,
                testAPIConnection,
                makeAPIRequest
            };
        }
        
        // Development mode helpers
        if (window.location.hostname === 'localhost') {
            window.expertAI = {
                switchToProduction: () => {
                    API_BASE_URL = PRODUCTION_API_URL;
                    systemMode = 'production';
                    updateSystemStatus('production', 'Switched to Production Mode');
                    testAPIConnection();
                },
                switchToDemo: () => {
                    API_BASE_URL = 'DEMO_MODE';
                    systemMode = 'demo';
                    updateSystemStatus('demo', 'Switched to Demo Mode');
                },
                getSystemInfo: () => {
                    return {
                        mode: systemMode,
                        apiUrl: API_BASE_URL,
                        isOnline: navigator.onLine
                    };
                }
            };
            console.log('Development helpers available: window.expertAI');
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
